\documentclass{article}

% =======================================================
% PHẦN 1: CẤU HÌNH GIAO DIỆN & GÓI LỆNH
% =======================================================

% --- Ngôn ngữ và Font chữ ---
\usepackage[utf8]{inputenc}
\usepackage[T5]{fontenc} % Hỗ trợ tiếng Việt
\usepackage[fontsize=13pt]{scrextend} % Cỡ chữ 13pt
\usepackage{mathptmx} % Font Times New Roman giả lập

% --- Căn lề và Khổ giấy ---
\usepackage[paperheight=29.7cm,paperwidth=21cm,right=2cm,left=3cm,top=2cm,bottom=2.5cm]{geometry}

% --- Các gói đồ họa và bảng biểu ---
\usepackage{graphicx} % Để chèn ảnh
\usepackage{float}    % Để cố định vị trí hình/bảng [H]
\usepackage{tikz}     % Để vẽ khung bìa
\usetikzlib\textbf{Phân tích Hình \ref{fig:jcas_boxplot}:}
\begin{itemize}
    \item \textbf{TSILS:} Không có phân phối (deterministic), xuất hiện như một điểm dương (+10.518) nằm xa trên trục y, cho thấy hiệu suất kém tuyệt đối.
    \item \textbf{GWO:} Phân phối rộng (từ -5.4 đến -7.6) nhưng median cao (-6.79), cho thấy khả năng tìm kiếm tốt với độ dao động chấp nhận được. \textbf{Vượt trội so với TSILS}.
    \item \textbf{WDGWO:} Phân phối rộng (từ -4.3 đến -7.2), xuất hiện outlier kém. Độ không ổn định cao là nhược điểm nhưng vẫn tốt hơn nhiều so với TSILS.
    \item \textbf{CGWO:} Phân phối hẹp, toàn bộ các trials cho kết quả gần giống nhau ở mức -4.9. Tuy hội tụ nhanh nhưng vẫn vượt trội hơn TSILS rất nhiều.
\end{itemize}alc}
\usepackage{indentfirst} % Thụt đầu dòng đoạn đầu tiên

% --- Cấu hình giãn dòng ---
\renewcommand{\baselinestretch}{1.2} % Giãn dòng 1.2
\setlength{\parskip}{6pt} % Khoảng cách giữa các đoạn
\setlength{\parindent}{1cm} % Thụt đầu dòng 1cm

% --- Định dạng Tiêu đề (Headings) ---
\usepackage{titlesec}
\setcounter{secnumdepth}{4}

% Heading 1: Căn giữa, In hoa, Đậm
\titlespacing*{\section}{0pt}{0pt}{30pt}
\titleformat*{\section}{\fontsize{16pt}{19.2pt}\selectfont \bfseries \centering}

% Heading 2: Căn trái, Đậm
\titlespacing*{\subsection}{0pt}{10pt}{0pt}
\titleformat*{\subsection}{\fontsize{14pt}{16.8pt}\selectfont \bfseries}

% Heading 3: Căn trái, Đậm, Nghiêng
\titlespacing*{\subsubsection}{0pt}{10pt}{0pt}
\titleformat*{\subsubsection}{\fontsize{13pt}{15.6pt}\selectfont \bfseries \itshape}

% --- Định dạng Caption (Hình 1, Bảng 1) ---
\usepackage[font=bf]{caption}
\renewcommand{\figurename}{\fontsize{12pt}{0pt}\selectfont \bfseries Hình} % Đổi thành Tiếng Việt
\renewcommand{\tablename}{\fontsize{12pt}{0pt}\selectfont \bfseries Bảng}
\captionsetup[figure]{labelsep=space}
\captionsetup[table]{labelsep=space}

% --- Các gói Toán học và Thuật toán ---
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{bm} % In đậm ký hiệu toán học
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{needspace}

% Định nghĩa lại Input/Output cho thuật toán
\renewcommand{\algorithmicrequire}{\textbf{Input:}}
\renewcommand{\algorithmicensure}{\textbf{Output:}}

% --- Hyperlink (Luôn để cuối cùng) ---
\usepackage[unicode]{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=black, % Màu đen để in ấn đẹp
    filecolor=magenta,
    urlcolor=cyan,
    pdftitle={Báo cáo GWO - HUST},
}

% --- Lệnh chèn ảnh an toàn (Tự động tạo khung nếu thiếu ảnh) ---
% Lệnh này giúp báo cáo không bị lỗi nếu bạn chưa kịp chép file ảnh mới vào
\newcommand{\safeincludegraphics}[2][]{%
    \IfFileExists{#2}{%
        \includegraphics[#1]{#2}%
    }{%
        \framebox{\begin{minipage}[c][0.6\linewidth]{\linewidth}%
            \centering \vspace{1cm} \textbf{[File ảnh chưa có: \detokenize{#2}]} \\ (Hãy chép file ảnh vào thư mục để hiển thị) \vspace{1cm}%
        \end{minipage}}%
    }%
}

% =======================================================
% BẮT ĐẦU NỘI DUNG TÀI LIỆU
% =======================================================
\begin{document}

% -------------------------------------------------------
% TRANG BÌA (Title Page)
% -------------------------------------------------------
\begin{titlepage}
    \begin{tikzpicture}[remember picture, overlay]
        \draw[line width = 3pt] ($(current page.north west) + (2cm,-2cm)$) rectangle ($(current page.south east) + (-1.5cm,2cm)$);
    \end{tikzpicture}

    \centering
    \vspace{1cm}
    
    \textbf{\fontsize{14pt}{0pt}\selectfont TRƯỜNG ĐẠI HỌC BÁCH KHOA HÀ NỘI}\\
    \textbf{\fontsize{14pt}{0pt}\selectfont VIỆN CÔNG NGHỆ THÔNG TIN VÀ TRUYỀN THÔNG}
    \vspace{1.5cm}
    \begin{figure}[H]
        \centering
        \includegraphics[width=4.5cm]{logo.png} % Bỏ comment nếu có logo trường
    \end{figure}    
    \textbf{\fontsize{24pt}{0pt}\selectfont BÁO CÁO TỔNG QUAN}\\
    \vspace{0.5cm}
    \textbf{\fontsize{20pt}{0pt}\selectfont GREY WOLF OPTIMIZER VÀ CÁC BIẾN THỂ CẢI TIẾN}
    
    \vspace{3cm}
    \begin{table}[H]
        \centering
        \begin{tabular}{l l}
            \textbf{\fontsize{14pt}{0pt}\selectfont Sinh viên thực hiện:} & \fontsize{14pt}{0pt}\selectfont Trịnh Đức Trung - 20235854 \\
             & \fontsize{14pt}{0pt}\selectfont Nguyễn Khắc Thanh Liêm - 20235764 \\[1cm]
            \textbf{\fontsize{14pt}{0pt}\selectfont Giảng viên hướng dẫn:} & \fontsize{14pt}{0pt}\selectfont Trịnh Văn Chiến \\
        \end{tabular}
    \end{table}
    \vfill
\end{titlepage}

% -------------------------------------------------------
% PHẦN MỞ ĐẦU (Tóm tắt & Mục lục)
% -------------------------------------------------------
\pagenumbering{roman} % Đánh số La Mã (i, ii...)

% --- Tóm tắt ---
\section*{TÓM TẮT}
\addcontentsline{toc}{section}{TÓM TẮT} % Thêm vào mục lục
\noindent
Thuật toán Tối ưu hóa Bầy sói Xám (GWO) là một thuật toán siêu heuristic (metaheuristic) thuộc nhóm trí tuệ bầy đàn (swarm intelligence), được giới thiệu bởi Seyedali Mirjalili và các đồng nghiệp vào năm 2014. Thuật toán này mô phỏng cấu trúc phân cấp xã hội và cơ chế săn mồi tập thể của bầy sói xám trong tự nhiên để giải quyết các bài toán tối ưu hóa phức tạp. Báo cáo này trình bày cơ sở lý thuyết, mô hình toán học, mã giả, và tổng quan về các biến thể cải tiến phổ biến của GWO, đồng thời đưa ra các minh chứng về hiệu quả của thuật toán trên các hàm chuẩn và bài toán thực tế.

\newpage

% --- Mục lục ---
\tableofcontents
\newpage

% -------------------------------------------------------
% NỘI DUNG CHÍNH (Các chương)
% -------------------------------------------------------
\pagenumbering{arabic} % Đánh số Ả Rập (1, 2, 3...)

% --- CHƯƠNG 1 ---
\section{THUẬT TOÁN GWO NGUYÊN BẢN}

\subsection{Nguồn cảm hứng Sinh học}
GWO mô phỏng hai khía cạnh chính trong hành vi của bầy sói xám: cấu trúc phân cấp xã hội và cơ chế săn mồi.

\subsubsection{Cấu trúc Phân cấp Xã hội}
Bầy sói xám duy trì một hệ thống phân cấp xã hội nghiêm ngặt. Trong mô hình GWO, quần thể (population) được chia thành bốn cấp. Ba cấp đầu tiên đại diện cho ba giải pháp tốt nhất (ưu việt nhất) mà thuật toán tìm thấy cho đến thời điểm hiện tại:
\begin{enumerate}
    \item \textbf{Sói Alpha ($\alpha$):} Là cá thể lãnh đạo. Trong thuật toán, \textbf{Alpha ($X_{\alpha}$)} được định nghĩa là \textbf{giải pháp tốt nhất (tối ưu nhất)} trong quần thể hiện tại.
    \item \textbf{Sói Beta ($\beta$):} Là cá thể cấp phó, hỗ trợ Alpha. Trong thuật toán, \textbf{Beta ($X_{\beta}$)} là \textbf{giải pháp tốt thứ hai}.
    \item \textbf{Sói Delta ($\delta$):} Là các cá thể tuân theo Alpha và Beta. Trong thuật toán, \textbf{Delta ($X_{\delta}$)} là \textbf{giải pháp tốt thứ ba}.
    \item \textbf{Sói Omega ($\omega$):} Là cấp bậc thấp nhất. Trong thuật toán, \textbf{Omega ($X_{\omega}$)} đại diện cho \textbf{tất cả các giải pháp ứng cử còn lại}. Chúng phải đi theo sự chỉ dẫn của ba con sói đầu đàn.
\end{enumerate}

Để hình dung rõ hơn về sự phân tầng quyền lực nghiêm ngặt này, sơ đồ kim tự tháp phân cấp xã hội của bầy sói xám được thể hiện trong Hình \ref{fig:hierarchy}.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.6\textwidth]{Fig1.png} 
    \caption{Sơ đồ phân cấp xã hội của loài sói xám (Alpha, Beta, Delta, Omega).}
    \label{fig:hierarchy}
\end{figure}

\subsubsection{Cơ chế Săn mồi}
Quá trình săn mồi tập thể (tối ưu hóa) được mô hình hóa qua ba giai đoạn:
\begin{enumerate}
    \item \textbf{Tìm kiếm con mồi (Thăm dò):} Bầy sói phân tán để tìm kiếm con mồi.
    \item \textbf{Bao vây (encircling) con mồi:} Khi con mồi được phát hiện, bầy sói hội tụ và bao vây nó.
    \item \textbf{Tấn công con mồi (Khai thác):} Bầy sói tấn công con mồi khi nó ngừng di chuyển.
\end{enumerate}

Các giai đoạn này không chỉ là lý thuyết mà được mô phỏng trực tiếp từ quan sát thực tế hành vi của sói trong tự nhiên. Hình \ref{fig:hunting_real} minh họa các bước từ việc đuổi theo, bao vây đến khi tấn công con mồi tĩnh.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.9\textwidth]{Fig2.png} 
    \caption{Hành vi săn mồi thực tế: (A) Đuổi theo và tiếp cận; (B-D) Truy đuổi và bao vây; (E) Tấn công.}
    \label{fig:hunting_real}
\end{figure}

\subsection{Mô hình Toán học}
Trong GWO, \textbf{con mồi} chính là \textbf{giải pháp tối ưu toàn cục (global optimum)}. Mục tiêu của bầy sói là tìm ra vị trí của con mồi này.

\subsubsection{Bao vây con mồi (Encircling)}
Mô hình toán học cho hành vi bao vây được mô tả như sau:
\[ \vec{D} = |\vec{C} \cdot \vec{X_p}(t) - \vec{X}(t)| \]
\[ \vec{X}(t+1) = \vec{X_p}(t) - \vec{A} \cdot \vec{D} \]
Trong đó:
\begin{itemize}
    \item $t$ là vòng lặp hiện tại.
    \item $\vec{X_p}$ là vector vị trí của con mồi (giải pháp tối ưu).
    \item $\vec{X}$ là vector vị trí của một con sói.
    \item $\vec{D}$ là vector khoảng cách giữa sói và con mồi.
    \item $\vec{A}$ và $\vec{C}$ là các vector hệ số.
\end{itemize}

Hình \ref{fig:vectors_2d_3d} minh họa cách các vector vị trí hoạt động trong không gian 2D và 3D. Bằng cách điều chỉnh các vector ngẫu nhiên, con sói có thể tiếp cận bất kỳ vị trí nào xung quanh giải pháp tốt nhất.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{Fig3.png} 
    \caption{Mô hình vector vị trí trong không gian 2D (a) và 3D (b) cùng các vị trí tiềm năng tiếp theo.}
    \label{fig:vectors_2d_3d}
\end{figure}

\subsubsection{Săn mồi (Hunting) - Cập nhật vị trí Omega}
Vấn đề mấu chốt là: vị trí của con mồi ($\vec{X_p}$) là không xác định. Để giải quyết điều này, GWO đưa ra một giả định: \textbf{ba con sói đầu đàn (Alpha, Beta, Delta) là ba con sói có thông tin tốt nhất về vị trí của con mồi}.

Do đó, tất cả các con sói Omega (các giải pháp còn lại) phải cập nhật vị trí của mình dựa trên vị trí trung bình của ba con sói tốt nhất này.

\textbf{Bước 1: Tính toán ``lực kéo'' từ 3 con đầu đàn}
Mỗi con sói Omega sẽ tính toán khoảng cách và hướng di chuyển của nó tới cả 3 con đầu đàn:
\[ \vec{D}_{\alpha} = |\vec{C}_1 \cdot \vec{X}_{\alpha} - \vec{X}(t)| \]
\[ \vec{D}_{\beta} = |\vec{C}_2 \cdot \vec{X}_{\beta} - \vec{X}(t)| \]
\[ \vec{D}_{\delta} = |\vec{C}_3 \cdot \vec{X}_{\delta} - \vec{X}(t)| \]
Các bước di chuyển tương ứng:
\[ \vec{X}_1 = \vec{X}_{\alpha} - \vec{A}_1 \cdot \vec{D}_{\alpha} \]
\[ \vec{X}_2 = \vec{X}_{\beta} - \vec{A}_2 \cdot \vec{D}_{\beta} \]
\[ \vec{X}_3 = \vec{X}_{\delta} - \vec{A}_3 \cdot \vec{D}_{\delta} \]

\textbf{Bước 2: Cập nhật vị trí cuối cùng}
Vị trí mới của con sói Omega sẽ là vị trí trung bình của 3 bước di chuyển trên:
\[ \vec{X}(t+1) = \frac{\vec{X}_1 + \vec{X}_2 + \vec{X}_3}{3} \]

Hình \ref{fig:position_update} mô tả trực quan quá trình này: con sói ước lượng vị trí con mồi dựa trên thông tin tổng hợp từ ba con đầu đàn và di chuyển ngẫu nhiên xung quanh khu vực đó.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.7\textwidth]{Fig4.png} 
    \caption{Cơ chế cập nhật vị trí trong GWO: Vị trí mới được xác định dựa trên Alpha, Beta và Delta.}
    \label{fig:position_update}
\end{figure}

\subsubsection{Thăm dò và Khai thác (Tham số \textit{a} và các Vector)}

Vector $\vec{A}$ được tính bởi:
\[ \vec{A} = 2\vec{a} \cdot \vec{r_1} - \vec{a} \]
Vector $\vec{C}$ được tính bởi:
\[ \vec{C} = 2 \cdot \vec{r_2} \]

Hai vector này đóng vai trò quyết định trong việc cân bằng giữa tìm kiếm toàn cục (Thăm dò) và tìm kiếm cục bộ (Khai thác):

\begin{itemize}
    \item \textbf{Vai trò của Vector $\vec{C}$ (Mô phỏng chướng ngại vật):}
    Khác với $\vec{A}$, vector $\vec{C}$ \textbf{không giảm tuyến tính}. Nó cung cấp trọng số ngẫu nhiên cho con mồi bất kể thuật toán đang ở giai đoạn nào. Điều này giúp thuật toán duy trì tính ngẫu nhiên, giúp bầy sói \textbf{tránh bị mắc kẹt tại các điểm tối ưu cục bộ}.
    
    \item \textbf{Cơ chế chuyển đổi hành vi qua Vector $\vec{A}$:}
    \begin{itemize}
        \item Khi $|\vec{A}| \ge 1$: Các con sói bị buộc phải \textbf{phân tán (diverge)} ra xa khỏi con mồi (Thăm dò - Exploration).
        \item Khi $|\vec{A}| < 1$: Các con sói bị ép \textbf{hội tụ (converge)} về phía con mồi (Khai thác - Exploitation).
    \end{itemize}
\end{itemize}

Sự khác biệt hành vi này được minh họa trong Hình \ref{fig:explore_exploit}.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{Fig5.png} 
    \caption{Sự khác biệt hành vi: (a) Tấn công con mồi (Khai thác) và (b) Tìm kiếm con mồi (Thăm dò).}
    \label{fig:explore_exploit}
\end{figure}

\subsection{Mã giả Thuật toán GWO (Pseudocode)}
Quy trình thực thi của GWO được mô tả chi tiết trong Thuật toán \ref{alg:gwo}.

\begin{center}
\fbox{
\begin{minipage}{0.9\textwidth} 
\begin{algorithm}[H] 
\caption{Thuật toán Grey Wolf Optimizer (GWO)}
\label{alg:gwo}
\begin{algorithmic}[1]
\STATE \textbf{BẮT ĐẦU}
\STATE \textit{// --- Giai đoạn 1: Khởi tạo ---}
\STATE Khởi tạo quần thể $N$ con sói $X_i$ ($i = 1, \dots, N$) ngẫu nhiên.
\STATE Khởi tạo các tham số $a, A$, và $C$.
\STATE Khởi tạo bộ đếm vòng lặp $t = 0$.

\STATE \textit{// --- Giai đoạn 2: Đánh giá ban đầu ---}
\STATE Tính toán giá trị thích nghi (fitness) cho mỗi con sói $X_i$.
\STATE $X_{\alpha}$ = cá thể có fitness tốt nhất.
\STATE $X_{\beta}$ = cá thể có fitness tốt thứ hai.
\STATE $X_{\delta}$ = cá thể có fitness tốt thứ ba.

\STATE \textit{// --- Giai đoạn 3: Vòng lặp chính ---}
\WHILE{($t < \text{MaxIterations}$)}
    \FOR{(mỗi con sói $X_i$ trong quần thể)}
        \STATE Cập nhật vị trí $X_i(t+1)$ dựa trên $X_{\alpha}, X_{\beta}, X_{\delta}$.
    \ENDFOR
    
    \STATE \textit{// Cập nhật các tham số điều khiển}
    \STATE Cập nhật giá trị của $a$ (giảm tuyến tính từ 2 về 0).
    \STATE Cập nhật giá trị của $A$ và $C$.
    
    \STATE \textit{// --- Giai đoạn 4: Đánh giá lại và Bầu cử ---}
    \STATE Tính toán giá trị thích nghi cho TẤT CẢ các con sói.
    \STATE Cập nhật $X_{\alpha}$, $X_{\beta}$, và $X_{\delta}$ nếu tìm thấy giải pháp ưu việt hơn.
    
    \STATE $t = t + 1$
\ENDWHILE

\STATE \textit{// --- Giai đoạn 5: Kết thúc ---}
\STATE \textbf{TRẢ VỀ} $X_{\alpha}$ (giải pháp tối ưu tìm được)
\STATE \textbf{KẾT THÚC}
\end{algorithmic}
\end{algorithm}
\end{minipage} 
} 
\end{center} 

% NGẮT TRANG SANG CHƯƠNG 2
\newpage

\section{PHÂN TÍCH VẤN ĐỀ VÀ CÁC BIẾN THỂ CẢI TIẾN CỦA GWO}
\label{sec:variants}

Phần này đi sâu phân tích các hạn chế cố hữu của thuật toán GWO nguyên bản và trình bày cách các biến thể cải tiến được đề xuất để giải quyết từng vấn đề cụ thể.

\subsection{Các Hạn chế Cố hữu của GWO Nguyên bản}
Mặc dù GWO nguyên bản có ưu điểm là cấu trúc đơn giản, nó bộc lộ ba hạn chế chính ảnh hưởng đến hiệu suất và phạm vi ứng dụng.

\subsubsection{Nguy cơ Hội tụ sớm (Sa vào Tối ưu Cục bộ)}
Đây là nhược điểm lớn nhất được ghi nhận của GWO. Thuật toán có nguy cơ bị ``mắc kẹt'' tại một giải pháp ``tốt'' nhưng \textit{không phải là tốt nhất}.

\begin{itemize}
\item \textbf{Nguyên nhân:} Hiện tượng này xảy ra khi cả ba con sói đầu đàn (Alpha, Beta, Delta) cùng hội tụ vào một \textbf{điểm tối ưu cục bộ (local optima)}. Do cơ chế của thuật toán, toàn bộ các con sói Omega còn lại sẽ bị ``hút'' về phía khu vực này theo công thức cập nhật trung bình.
\item \textbf{Cơ chế ``khóa'':} Vấn đề trở nên nghiêm trọng hơn do vai trò của tham số $a$ (giảm tuyến tính từ 2 về 0). Nếu bầy sói bị kẹt vào tối ưu cục bộ \textit{sau khi} $a$ đã giảm xuống dưới 1, thuật toán sẽ bị khóa vĩnh viễn trong chế độ ``Khai thác'' ($|A| < 1$). Lúc này, bầy sói mất khả năng ``Thăm dò'' (tức là thực hiện các bước nhảy đủ xa) để ``thoát'' ra khỏi điểm tối ưu cục bộ đó.
\end{itemize}

\subsubsection{Tốc độ hội tụ chậm về cuối (Thiếu bứt phá)}
Một vấn đề khác là thuật toán thường biểu hiện sự ``lờ đờ'' và thiếu bứt phá khi tiến gần đến giải pháp tối ưu.

\begin{itemize}
\item \textbf{Nguyên nhân:} Điều này xuất phát từ công thức cập nhật vị trí:
\[ X(t+1) = \frac{X_1 + X_2 + X_3}{3} \]
Ở giai đoạn cuối, cả Alpha, Beta và Delta đều đã hội tụ rất gần nhau. Việc lấy \textbf{trung bình cộng} khiến các con sói Omega bị kéo về \textit{trung tâm} của ba con sói này, chứ không bị kéo dứt khoát về phía con sói Alpha (giải pháp tốt nhất).
\end{itemize}

\subsection{Các Biến thể Cải tiến và Giải pháp}
Để khắc phục các nhược điểm trên, nhiều biến thể đã được đề xuất.

\subsubsection{Biến thể về Tham số Kiểm soát (Modified Control Parameter)}
\begin{itemize}
\item \textbf{Vấn đề giải quyết:} Vấn đề 1 (Hội tụ sớm) và Vấn đề 2 (Hội tụ chậm).
\item \textbf{Phân tích vấn đề gốc:} Thuật toán GWO nguyên bản sử dụng tham số $a$ giảm \textbf{tuyến tính} (giảm theo đường thẳng) từ 2 về 0. Cơ chế này tạo ra một sự phân chia 50/50 cứng nhắc.
\item \textbf{Cơ chế cải tiến chi tiết:} Biến thể này thay thế công thức giảm tuyến tính của $a$ bằng một \textbf{hàm phi tuyến tính}. Các hàm này cho phép kiểm soát quá trình chuyển đổi một cách linh hoạt hơn.
\begin{itemize}
\item \textbf{Ví dụ (Hàm Cosine):} Một hàm phi tuyến tính phổ biến được sử dụng là:
\[ a(t) = 1 + \cos\left(\frac{t}{T_{\text{max}}} \cdot \pi\right) \]
(Trong đó $t$ là vòng lặp hiện tại và $T_{\text{max}}$ là tổng số vòng lặp).
\end{itemize}
\item \textbf{Tác động (Mục đích):}
\begin{itemize}
\item \textbf{Giải quyết VĐ1 (Hội tụ sớm):} Việc $a$ giảm chậm ở đầu giúp ``dành nhiều thời gian hơn cho việc thăm dò''.
\item \textbf{Giải quyết VĐ2 (Hội tụ chậm):} Việc $a$ lao dốc ở cuối giúp ``thúc đẩy hội tụ nhanh ở giai đoạn cuối''.
\end{itemize}
\end{itemize}

\subsubsection{Biến thể Hỗn loạn (Chaotic GWO - CGWO)}
\begin{itemize}
\item \textbf{Vấn đề giải quyết:} Trực tiếp giải quyết \textbf{Vấn đề 1 (Sa vào Tối ưu Cục bộ)}.
\item \textbf{Phân tích vấn đề gốc:} GWO gốc dựa vào các vector ngẫu nhiên $r_1$ và $r_2$ (từ 0 đến 1) để tính toán $A$ và $C$. Các số này là ``giả ngẫu nhiên'' và có thể không bao phủ đồng đều toàn bộ không gian.
\item \textbf{Cơ chế cải tiến chi tiết:} Biến thể này thay thế các biến ngẫu nhiên tiêu chuẩn bằng các chuỗi số được tạo ra từ \textbf{``Bản đồ hỗn loạn'' (Chaotic Maps)}.
\begin{itemize}
\item \textbf{Ví dụ (Logistic Map):}
\[ x_{t+1} = \mu \cdot x_t \cdot (1 - x_t) \]
\end{itemize}
\item \textbf{Tác động (Mục đích):} Các chuỗi hỗn loạn có tính phi tuyến tính và bao phủ không gian tốt hơn, tạo ra các ``cú hích ngẫu nhiên mạnh mẽ''.
\end{itemize}

\subsubsection{Biến thể dựa trên Trọng số (Weighted GWO)}
\begin{itemize}
\item \textbf{Vấn đề giải quyết:} Trực tiếp giải quyết \textbf{Vấn đề 2 (Tốc độ hội tụ chậm về cuối)}.
\item \textbf{Phân tích vấn đề gốc:} Nguyên nhân là công thức cập nhật vị trí lấy trung bình cộng, khiến Alpha, Beta, và Delta có ảnh hưởng ngang nhau.
\item \textbf{Cơ chế cải tiến chi tiết:} Thay thế phép trung bình cộng bằng phép \textbf{trung bình có trọng số}.
\[ X(t+1) = \frac{w_1 X_1 + w_2 X_2 + w_3 X_3}{w_1 + w_2 + w_3} \]
\begin{itemize}
\item \textbf{Trọng số Động (Dynamic Weights):} Các trọng số $w_1, w_2, w_3$ được \textbf{tính toán lại ở mỗi vòng lặp} dựa trên giá trị fitness. Con sói nào có Fitness càng tốt thì sẽ có trọng số càng lớn.
\end{itemize}
\item \textbf{Tác động \& Mục đích:} Phương pháp này tạo ra một cơ chế khai thác \textbf{thích ứng (adaptive)}. Khi Alpha vượt trội, trọng số $w_1$ sẽ tiến gần tới 100\%, giúp tăng tốc hội tụ.
\end{itemize}

% =======================================================
% CHƯƠNG 3: THỰC NGHIỆM VÀ ĐÁNH GIÁ (FULL CODE)
% =======================================================
\section{THỰC NGHIỆM VÀ ĐÁNH GIÁ}

Trong chương này, chúng tôi tiến hành đánh giá hiệu quả của biến thể \textit{Weighted Dynamic GWO} qua hai giai đoạn. Giai đoạn đầu kiểm chứng nhanh khả năng hội tụ trên hàm chuẩn toán học (Rosenbrock). Giai đoạn hai tập trung sâu vào khả năng giải quyết bài toán tối ưu tổ hợp thực tế: Bài toán Người du lịch (TSP).

% -------------------------------------------------------
% 3.1. ROSENBROCK (TÓM TẮT)
% -------------------------------------------------------
\subsection{Kiểm chứng nhanh trên Hàm chuẩn Rosenbrock}

Hàm Rosenbrock (hàm thung lũng) là một hàm không lồi, đơn mode, nổi tiếng với cực tiểu nằm trong một thung lũng hẹp và phẳng, gây khó khăn cho việc hội tụ chính xác.
\begin{equation}
    f_{Rosenbrock}(x) = \sum_{i=1}^{D-1} \left[ 100(x_{i+1} - x_i^2)^2 + (1 - x_i)^2 \right]
\end{equation}
Cực tiểu toàn cục nằm tại $x = (1, 1, \dots, 1)$ với giá trị $f_{min} = 0$.

\subsubsection{Kết quả so sánh hội tụ}
Thực nghiệm so sánh giữa GWO gốc, Weighted Static và Weighted Dynamic cho thấy sự khác biệt rõ rệt về khả năng "đào sâu" tìm nghiệm.

\begin{figure}[H]
    \centering
    % Sử dụng tên file gốc từ source code cũ của bạn
    \safeincludegraphics[width=0.85\textwidth]{Convergence – Best Runs.png} 
    \caption{So sánh tốc độ hội tụ trên hàm Rosenbrock (Log scale).}
    \label{fig:convergence}
\end{figure}

Như thể hiện ở Hình \ref{fig:convergence}, trong khi GWO gốc và Static bị bão hòa sớm (đường nằm ngang) ở mức lỗi $10^0$, biến thể \textbf{Weighted Dynamic} tiếp tục duy trì đà giảm fitness sau vòng lặp 400 nhờ cơ chế trọng số linh hoạt, tiếp cận gần hơn với cực trị toàn cục. Điều này khẳng định thuật toán đề xuất có khả năng thoát khỏi tối ưu cục bộ tốt hơn trên không gian liên tục.

% -------------------------------------------------------
% 3.2. TSP (TRỌNG TÂM)
% -------------------------------------------------------
\newpage
\subsection{Ứng dụng trọng tâm: Giải quyết bài toán Người du lịch (TSP)}

Bài toán TSP đặt ra thách thức lớn hơn do không gian tìm kiếm rời rạc và bùng nổ tổ hợp (NP-hard). Mục tiêu là tìm lộ trình ngắn nhất đi qua $N$ thành phố và quay về điểm xuất phát mà không lặp lại thành phố nào.

\subsubsection{Cơ chế Mã hóa Khóa Ngẫu nhiên (Random Key Encoding)}
Do GWO là thuật toán hoạt động trên số thực (continuous), để áp dụng cho bài toán hoán vị (permutation) như TSP, chúng tôi sử dụng kỹ thuật \textbf{Random Key Encoding}. Kỹ thuật này giúp chuyển đổi vector vị trí của sói sang lộ trình du lịch mà không phá vỡ cấu trúc của GWO.

Quy trình giải mã (Decode) diễn ra như sau:
\begin{enumerate}
    \item Mỗi con sói mang một vector số thực $X = [x_1, x_2, \dots, x_N]$.
    \item Thực hiện sắp xếp vector $X$ theo thứ tự tăng dần.
    \item \textbf{Chỉ số ban đầu (index)} của các phần tử sau khi sắp xếp chính là thứ tự ghé thăm thành phố.
\end{enumerate}

\textbf{Ví dụ minh họa:}
Với 3 thành phố, giả sử vector vị trí của sói là $X = [0.75, 0.12, 0.93]$.
\begin{itemize}
    \item Giá trị sau khi sắp xếp: $0.12$ (tại index 2) $< 0.75$ (tại index 1) $< 0.93$ (tại index 3).
    \item Lộ trình tương ứng: \textbf{Thành phố 2 $\rightarrow$ Thành phố 1 $\rightarrow$ Thành phố 3}.
\end{itemize}

\subsubsection{Thuật toán Weighted Dynamic GWO cho TSP}
Để giải quyết bài toán TSP, chúng tôi tích hợp cơ chế giải mã trên vào vòng lặp của Weighted Dynamic GWO. Chi tiết quy trình được trình bày trong Thuật toán \ref{alg:tsp_gwo_dynamic}.

\begin{center}
\begin{minipage}{0.95\textwidth} 
\begin{algorithm}[H] 
\caption{Weighted Dynamic GWO giải bài toán TSP (Mã hóa Khóa ngẫu nhiên)}
\label{alg:tsp_gwo_dynamic}
\begin{algorithmic}[1]
\REQUIRE Tọa độ $N$ thành phố, $Max\_iter$, Số lượng sói $PopSize$.
\ENSURE Lộ trình tối ưu $P_{best}$ và độ dài $L_{min}$.

\STATE \textbf{Khởi tạo:} 
\STATE Tạo quần thể $X$ ngẫu nhiên trong khoảng $[0, 1]$ (kích thước $PopSize \times N$).
\STATE $X_\alpha, X_\beta, X_\delta \leftarrow \emptyset; \quad f_\alpha, f_\beta, f_\delta \leftarrow \infty$

\STATE \textit{// --- Vòng lặp chính ---}
\FOR{$t = 0$ \textbf{to} $Max\_iter - 1$}
    
    \STATE \textit{// 1. Đánh giá và Xếp hạng}
    \FOR{$i = 1$ \textbf{to} $PopSize$}
        \STATE $P_i \leftarrow \textbf{Argsort}(X_i)$ \COMMENT{Giải mã vector thực sang hoán vị}
        \STATE $fitness \leftarrow \text{CalculateDistance}(P_i)$
        \IF{$fitness < f_\alpha$}
            \STATE Cập nhật $X_\alpha, f_\alpha$ (tương tự cho $\beta, \delta$).
        \ENDIF
    \ENDFOR

    \STATE \textit{// 2. Tính toán Trọng số Động (Logic cải tiến)}
    \STATE $f_{min} \leftarrow f_\alpha; \quad f_{max} \leftarrow \max(f_\alpha, f_\beta, f_\delta)$
    \STATE Tính khoảng cách chuẩn hóa cho $k \in \{\alpha, \beta, \delta\}$:
    \STATE \quad $Gap_k = (f_{max} - f_k) / (f_{max} - f_{min} + \epsilon)$
    \STATE Tính trọng số thô (Power Law): $w_k^{raw} = Gap_k^{2.8}$
    
    \STATE \textit{Pha trộn chiến thuật:}
    \STATE $a = 2 \cdot (1 - (t/Max\_iter)^{0.6})$
    \STATE $F_{exploit} = (1 - a/2)^3; \quad F_{explore} = 1 - F_{exploit}$
    \STATE $w_k = w_k^{raw} \cdot F_{exploit} + \frac{1}{3} \cdot F_{explore} + \mathcal{U}(-10^{-4}, 10^{-4})$
    \STATE Chuẩn hóa lại để $\sum w_k = 1$.

    \STATE \textit{// 3. Cập nhật vị trí}
    \FOR{$i = 1$ \textbf{to} $PopSize$}
        \STATE Tính $X_1, X_2, X_3$ hướng về $X_\alpha, X_\beta, X_\delta$ (công thức GWO chuẩn).
        \STATE $X_i(t+1) = w_1 X_1 + w_2 X_2 + w_3 X_3$
        \STATE Kẹp giá trị $X_i(t+1)$ trong biên $[0, 1]$.
    \ENDFOR
\ENDFOR

\RETURN Lộ trình $\textbf{Argsort}(X_\alpha)$ và chi phí $f_\alpha$.
\end{algorithmic}
\end{algorithm}
\end{minipage} 
\end{center}

\subsubsection{Phân tích kết quả thực nghiệm}
Thử nghiệm được thực hiện trên tập dữ liệu 20 thành phố ngẫu nhiên. Để đánh giá toàn diện hiệu quả của thuật toán Weighted Dynamic GWO, chúng tôi đi sâu phân tích ba khía cạnh riêng biệt: tốc độ hội tụ, hành vi thích nghi của trọng số và chất lượng lộ trình cuối cùng.

% --- HÌNH 1: TỐC ĐỘ HỘI TỤ ---
\paragraph{Tốc độ hội tụ và Khả năng tìm kiếm:}
Hình \ref{fig:tsp_conv} so sánh quá trình giảm tổng quãng đường (fitness) của ba biến thể qua 500 vòng lặp.

\begin{figure}[H]
    \centering
    \safeincludegraphics[width=0.85\textwidth]{Figure_1_TSP.png} 
    \caption{So sánh tốc độ hội tụ giữa các biến thể.}
    \label{fig:tsp_conv}
\end{figure}

\textbf{Nhận xét:} 
\begin{itemize}
    \item \textbf{GWO Gốc (Original) và Static:} Cả hai đường (màu xanh dương và cam) đều có xu hướng giảm nhanh ở 50 vòng lặp đầu nhưng nhanh chóng bị bão hòa (nằm ngang) ngay sau đó. Điều này cho thấy thuật toán đã rơi vào trạng thái tối ưu cục bộ và không thể tìm ra cấu hình tốt hơn dù số vòng lặp còn nhiều.
    \item \textbf{Weighted Dynamic:} Đường màu xanh lá thể hiện sự ưu việt khi liên tục "đào sâu" tìm kiếm. Ngay cả ở giai đoạn cuối (vòng lặp 300-500), đồ thị vẫn xuất hiện các bước giảm bậc thang. Điều này chứng tỏ cơ chế trọng số động vẫn duy trì được động lực tìm kiếm, giúp thuật toán tinh chỉnh lộ trình đến mức tối ưu nhất.
\end{itemize}

% --- HÌNH 2: TRỌNG SỐ ---
\paragraph{Cơ chế thích nghi của Trọng số trong không gian rời rạc: }
Sự khác biệt cốt lõi của biến thể đề xuất nằm ở cách các trọng số $w_1, w_2, w_3$ biến đổi theo thời gian thực, được minh họa trong Hình \ref{fig:tsp_weight}.

\begin{figure}[H]
    \centering
    \safeincludegraphics[width=0.9\textwidth]{Figure_2_TSP.png} 
    \caption{Biến động của các trọng số trong quá trình chạy Weighted Dynamic.}
    \label{fig:tsp_weight}
\end{figure}

\textbf{Nhận xét:}
Khác với sự biến đổi mượt mà trong các hàm toán học liên tục, đối với bài toán tổ hợp rời rạc như TSP, đồ thị trọng số xuất hiện rất nhiều "gai nhọn" (dao động mạnh). 
\begin{itemize}
    \item \textbf{Lý do:} Trong kỹ thuật \textit{Random Key Encoding}, một thay đổi nhỏ trong giá trị số thực của vector vị trí có thể không làm thay đổi thứ tự sắp xếp (index) của các thành phố. 
    \item \textbf{Tác dụng:} Các dao động mạnh và đột ngột của trọng số đóng vai trò như những "cú hích" (impulses), giúp vector vị trí thay đổi đủ lớn để tạo ra các hoán vị mới. Đây chính là cơ chế "rung lắc" thông minh giúp bầy sói thoát khỏi các cấu hình lộ trình bị kẹt.
\end{itemize}

% --- HÌNH 3: LỘ TRÌNH ---
\paragraph{Chất lượng lộ trình và Vấn đề "Giao điểm chết": }
Kết quả cuối cùng trực quan nhất chính là hình dạng lộ trình di chuyển của người du lịch được vẽ lại trong Hình \ref{fig:tsp_path}.

\begin{figure}[H]
    \centering
    \safeincludegraphics[width=\textwidth]{Figure_3_TSP.png} 
    \caption{So sánh trực quan lộ trình tìm được của 3 biến thể.}
    \label{fig:tsp_path}
\end{figure}

\textbf{Nhận xét:}
\begin{itemize}
    \item \textbf{GWO Gốc \& Static:} Lộ trình tìm được chứa các đường cắt chéo (giao điểm X). Trong hình học Euclide, theo bất đẳng thức tam giác, tổng độ dài hai đường chéo luôn lớn hơn tổng hai cạnh đối diện. Do đó, bất kỳ lộ trình nào còn tồn tại giao điểm cắt chéo đều là lộ trình chưa tối ưu.
    \item \textbf{Weighted Dynamic:} Lộ trình tạo thành một đa giác khép kín hoàn hảo, \textbf{không có bất kỳ đường cắt chéo nào}. Các nút thắt đã được gỡ bỏ hoàn toàn, mang lại tổng quãng đường ngắn nhất. Kết quả này khẳng định biến thể đề xuất có khả năng giải quyết triệt để bài toán TSP ở quy mô thử nghiệm.
\end{itemize}

\subsection{Kết luận chương 3}
Kết quả thực nghiệm khẳng định tính ưu việt của phương pháp đề xuất. Trên bài toán TSP, cơ chế trọng số động không chỉ giúp cải thiện độ chính xác mà còn thể hiện sự thích nghi thông minh: tự động tạo ra các dao động mạnh để tìm kiếm các hoán vị mới, giải quyết triệt để vấn đề "cắt chéo đường đi" mà các thuật toán tĩnh thường gặp phải.

% =======================================================
% PHẦN 3: THỰC THI TRÊN BÀI TOÁN JCAS
% =======================================================
\newpage
\section{ỨNG DỤNG GWO VÀO BÀI TOÁN TRUYỀN THÔNG: JCAS MULTIBEAM OPTIMIZATION}

\subsection{Giới thiệu bài toán JCAS}

\subsubsection{Bối cảnh và Động lực}
Trong hệ thống truyền thông không dây hiện đại, \textbf{JCAS (Joint Communication and Sensing)} là một xu hướng công nghệ tiên tiến, kết hợp đồng thời hai chức năng: truyền thông (Communication) và cảm biến/radar (Sensing) trên cùng một hệ thống anten. Thách thức lớn nhất là thiết kế các chùm tia sóng (beams) sao cho:
\begin{itemize}
    \item \textbf{Chùm truyền thông:} Hướng về phía người dùng với độ tăng ích cao nhất (maximize main lobe gain).
    \item \textbf{Chùm cảm biến:} Quét toàn bộ không gian để phát hiện vật thể.
    \item \textbf{Tối ưu chung:} Giảm thiểu nhiễu loại sidelobe (interference), đảm bảo chất lượng truyền thông và độ nhạy cảm biến.
\end{itemize}

\subsubsection{Mô hình toán học}
Hệ thống sử dụng mảng anten tuyến tính đều (Uniform Linear Array - ULA) với \(M = 12\) phần tử. Vector trọng số beamforming \(\mathbf{w} \in \mathbb{C}^M\) được biểu diễn dưới dạng:
\[
\mathbf{w} = \mathbf{w}_{\text{real}} + j\mathbf{w}_{\text{imag}}
\]

\textbf{Array Response Pattern:}
\[
P(\theta) = \left| \mathbf{w}^H \mathbf{A}(\theta) \right|^2
\]
trong đó \(\mathbf{A}(\theta)\) là ma trận steering vector cho các hướng tương đương (equivalent directions).

\textbf{Hàm mục tiêu (Minimize):}
\[
f(\mathbf{w}) = -G_{\text{main}} + \alpha \cdot \text{SLL}_{\text{max}} + \beta \cdot \text{SLL}_{\text{avg}} + \gamma \cdot \sigma_P
\]
với:
\begin{itemize}
    \item \(G_{\text{main}}\): Độ tăng ích tại hướng mong muốn (dB)
    \item \(\text{SLL}_{\text{max}}\): Mức sidelobe cao nhất (dB)
    \item \(\text{SLL}_{\text{avg}}\): Mức sidelobe trung bình (dB)
    \item \(\sigma_P\): Độ lệch chuẩn của pattern (uniformity)
    \item \(\alpha, \beta, \gamma\): Hệ số trọng số (được chọn là 0.5, 0.3, 0.2)
\end{itemize}

\subsubsection{Biến quyết định và Không gian tìm kiếm}
\begin{itemize}
    \item \textbf{Số chiều:} \(D = 2M = 24\) (12 phần tử real + 12 phần tử imaginary)
    \item \textbf{Miền giá trị:} \(w_i \in [-1, 1]\) (được chuẩn hóa sau mỗi bước tính)
    \item \textbf{Ràng buộc:} Normalized: \(\|\mathbf{w}\|_2 = 1\)
\end{itemize}

\subsection{Thiết lập thí nghiệm}

\subsubsection{Tham số thử nghiệm}
\begin{table}[H]
\centering
\caption{Tham số cấu hình thí nghiệm JCAS}
\begin{tabular}{|l|c|}
\hline
\textbf{Tham số} & \textbf{Giá trị} \\ \hline
Số phần tử anten (M) & 12 \\ \hline
Số hướng tương đương & 320 \\ \hline
Số sói (Population) & 30 \\ \hline
Số vòng lặp (Iterations) & 200 \\ \hline
Số lần chạy (Trials) & 10 \\ \hline
Hướng mong muốn (desired direction) & 0.0 rad (boresight) \\ \hline
Tham số trọng số động (power) & 2.8 \\ \hline
Chaotic map type & Tent map \\ \hline
\end{tabular}
\end{table}

\subsubsection{Các thuật toán được so sánh}
\begin{enumerate}
    \item \textbf{TSILS (Two-Step Iterative Least Squares):} Phương pháp baseline được thiết kế đặc biệt cho JCAS trong paper gốc. Sử dụng Capon's beamforming initialization và iterative least-squares optimization.
    \item \textbf{GWO (Grey Wolf Optimizer):} Thuật toán gốc với trọng số đều \(w_1 = w_2 = w_3 = 1/3\).
    \item \textbf{WDGWO (Weighted Dynamic GWO):} Biến thể đề xuất với trọng số thích ứng theo khoảng cách fitness.
    \item \textbf{CGWO (Chaotic GWO):} Sử dụng ánh xạ hỗn loạn (Tent map) thay thế số ngẫu nhiên.
\end{enumerate}

\subsection{Kết quả thực nghiệm: So sánh các thuật toán}

\subsubsection{Bảng thống kê tổng hợp}
Bảng \ref{tab:jcas_results} tổng hợp kết quả sau 10 lần chạy độc lập của mỗi thuật toán:

\begin{table}[H]
\centering
\caption{So sánh hiệu suất các thuật toán trên bài toán JCAS}
\label{tab:jcas_results}
\begin{tabular}{|l|c|c|c|c|c|}
\hline
\textbf{Thuật toán} & \textbf{Best} & \textbf{Worst} & \textbf{Mean} & \textbf{Std} & \textbf{Median} \\ \hline
\textbf{TSILS}  & +10.518 & +10.518 & +10.518 & 0.000 & +10.518 \\ \hline
\textbf{GWO}    & -7.560 & -5.430 & -6.766 & 0.560 & -6.790 \\ \hline
WDGWO           & -7.214 & -4.284 & -6.314 & 0.931 & -6.676 \\ \hline
CGWO            & -5.083 & -4.804 & -4.900 & 0.081 & -4.900 \\ \hline
\end{tabular}
\end{table}

\textbf{Lưu ý:} Với hàm mục tiêu minimize, giá trị âm lớn hơn (về trị tuyệt đối) là tốt hơn. TSILS có giá trị dương (+10.518) cho thấy hiệu suất rất kém.

\subsubsection{Nhận xét và Phân tích}
\paragraph{GWO nguyên bản (Baseline):}
\begin{itemize}
    \item Đạt kết quả \textbf{tốt nhất} với Mean = -6.766 và Best = -7.560.
    \item Độ ổn định trung bình (Std = 0.560).
    \item Được chọn làm baseline để so sánh.
\end{itemize}

\paragraph{Weighted Dynamic GWO (WDGWO):}
\begin{itemize}
    \item Mean = -6.314, \textbf{kém hơn GWO baseline 6.69\%}.
    \item Độ ổn định kém hơn (Std = 0.931 cao nhất).
    \item \textbf{Nguyên nhân:} Cơ chế trọng số động trong không gian liên tục phức tạp (24 chiều với biến phức) có thể gây dao động mạnh, làm giảm khả năng hội tụ tinh. Khác với TSP (không gian rời rạc có lợi từ dao động), bài toán JCAS yêu cầu tinh chỉnh liên tục các giá trị thực.
\end{itemize}

\paragraph{Chaotic GWO (CGWO):}
\begin{itemize}
    \item Mean = -4.900, \textbf{kém hơn GWO baseline 27.58\%} (tệ nhất).
    \item Độ ổn định rất cao (Std = 0.081) nhưng \textbf{hội tụ sớm vào local optima}.
    \item \textbf{Nguyên nhân:} Tent map tạo ra chuỗi giá trị xác định (deterministic chaos), giảm tính ngẫu nhiên cần thiết cho exploration trong không gian 24 chiều phức tạp. Thuật toán bị kẹt tại các giá trị fitness tương tự nhau (-4.8 đến -5.1) ngay từ vòng lặp 20 và không cải thiện được.
\end{itemize}

\subsection{Đồ thị hội tụ}

\begin{figure}[H]
    \centering
    \safeincludegraphics[width=0.95\textwidth]{../jcas_experiments/results/convergence_comparison.png}
    \caption{So sánh tốc độ hội tụ của GWO, WDGWO và CGWO trên bài toán JCAS}
    \label{fig:jcas_convergence}
\end{figure}

\textbf{Quan sát từ Hình \ref{fig:jcas_convergence}:}
\begin{itemize}
    \item \textbf{TSILS (màu tím):} Hiệu suất cực kém, fitness dương (+10.518) cho thấy phương pháp này không phù hợp với bài toán tối ưu multibeam JCAS. TSILS là phương pháp deterministic nên không có độ dao động.
    \item \textbf{GWO (màu xanh dương):} Đạt hiệu suất \textbf{tốt nhất} với fitness trung bình -6.766, cải thiện \textbf{164.33\%} so với TSILS. Giảm mạnh trong 100 vòng lặp đầu, sau đó tiếp tục cải thiện đều đặn. Đường hội tụ mượt mà và ổn định.
    \item \textbf{WDGWO (màu đỏ):} Đạt kết quả tốt (fitness -6.314), cải thiện 160.03\% so với TSILS, nhưng vùng std (bóng mờ) rộng cho thấy tính không ổn định cao.
    \item \textbf{CGWO (màu xanh lá):} Hội tụ nhanh nhưng tại giá trị kém hơn (-4.900), chỉ cải thiện 146.58\% so với TSILS. Dấu hiệu premature convergence.
\end{itemize}

\subsection{Phân phối fitness cuối cùng (Boxplot)}

\begin{figure}[H]
    \centering
    \safeincludegraphics[width=0.85\textwidth]{../jcas_experiments/results/boxplot_comparison.png}
    \caption{Phân phối giá trị fitness cuối cùng sau 10 trials}
    \label{fig:jcas_boxplot}
\end{figure}

\textbf{Phân tích Hình \ref{fig:jcas_boxplot}:}
\begin{itemize}
    \item \textbf{GWO:} Phân phối rộng (từ -5.4 đến -7.6) nhưng median cao (-6.79), cho thấy khả năng tìm kiếm tốt với độ dao động chấp nhận được.
    \item \textbf{WDGWO:} Phân phối rất rộng (từ -4.3 đến -7.2), xuất hiện outlier kém. Độ không ổn định cao là nhược điểm lớn.
    \item \textbf{CGWO:} Phân phối \textbf{cực hẹp} (gần như một đường ngang), toàn bộ các trials cho kết quả gần giống nhau ở mức kém. Đây là bằng chứng của việc thuật toán bị trapped.
\end{itemize}

\subsection{Beam Patterns của các solution tốt nhất}

\begin{figure}[H]
    \centering
    \safeincludegraphics[width=\textwidth]{../jcas_experiments/results/beam_patterns.png}
    \caption{So sánh beam pattern tốt nhất của mỗi thuật toán}
    \label{fig:jcas_beams}
\end{figure}

\textbf{Phân tích Hình \ref{fig:jcas_beams}:}
\begin{itemize}
    \item \textbf{GWO (fitness = -7.560):} 
    \begin{itemize}
        \item Main lobe tại direction = 0 đạt 0 dB (chuẩn hóa).
        \item Sidelobe level thấp (-30 dB đến -35 dB).
        \item Pattern mượt mà, không có peak nhiễu cao.
        \item \textbf{Kết luận:} Đây là pattern tốt nhất, đạt được cân bằng tốt giữa main lobe gain và sidelobe suppression.
    \end{itemize}
    
    \item \textbf{WDGWO (fitness = -7.214):}
    \begin{itemize}
        \item Main lobe tốt, sidelobe trung bình (~-30 dB).
        \item Pattern có một số dao động nhỏ.
        \item \textbf{Kết luận:} Chấp nhận được nhưng kém hơn GWO một chút.
    \end{itemize}
    
    \item \textbf{CGWO (fitness = -5.083):}
    \begin{itemize}
        \item Main lobe tốt nhưng sidelobe \textbf{cao hơn nhiều} (~-20 dB đến -25 dB).
        \item Pattern có nhiều nhiễu, không đều.
        \item \textbf{Kết luận:} Không đạt yêu cầu về sidelobe suppression, gây nhiễu cao.
    \end{itemize}
\end{itemize}

\subsection{Metrics chi tiết của solution tốt nhất}

\begin{table}[H]
\centering
\caption{So sánh các metrics kỹ thuật chi tiết}
\begin{tabular}{|l|c|c|c|}
\hline
\textbf{Metric} & \textbf{GWO} & \textbf{WDGWO} & \textbf{CGWO} \\ \hline
Main Lobe Gain (dB) & -0.032 & 0.000 & -0.010 \\ \hline
Max Sidelobe Level (dB) & 0.000 & 0.000 & 0.000 \\ \hline
Avg Sidelobe Level (dB) & -37.93 & -34.58 & -24.89 \\ \hline
Pattern Std & 18.93 & 15.80 & 11.87 \\ \hline
\textbf{Fitness} & \textbf{-7.560} & -7.214 & -5.083 \\ \hline
\end{tabular}
\end{table}

\textbf{Nhận xét:}
\begin{itemize}
    \item \textbf{Avg Sidelobe Level:} GWO đạt -37.93 dB (tốt nhất), CGWO chỉ đạt -24.89 dB (kém hơn 13 dB).
    \item \textbf{Pattern Std:} GWO có std cao nhất (18.93) cho thấy có độ tương phản cao giữa main lobe và sidelobe - đây là điều mong muốn trong thiết kế beam.
\end{itemize}

\subsection{Phần trăm cải thiện so với baseline}

\begin{table}[H]
\centering
\caption{Phần trăm thay đổi so với GWO nguyên bản}
\begin{tabular}{|l|c|c|}
\hline
\textbf{Thuật toán} & \textbf{Mean Fitness} & \textbf{Improvement (\%)} \\ \hline
GWO (Baseline) & -6.766 & 0.00\% \\ \hline
WDGWO & -6.314 & \textcolor{red}{-6.69\%} (kém hơn) \\ \hline
CGWO & -4.900 & \textcolor{red}{-27.58\%} (kém hơn) \\ \hline
\end{tabular}
\end{table}

\subsection{Thảo luận và Giải thích}

\subsubsection{Tại sao các biến thể không hiệu quả trên JCAS?}

\paragraph{1. Đặc điểm không gian tìm kiếm:}
\begin{itemize}
    \item \textbf{TSP:} Không gian rời rạc (hoán vị), dao động mạnh giúp thoát local optima.
    \item \textbf{JCAS:} Không gian liên tục 24 chiều, yêu cầu tinh chỉnh nhỏ và ổn định. Dao động quá mạnh phá vỡ cấu trúc tốt đã tìm được.
\end{itemize}

\paragraph{2. Độ phức tạp landscape:}
\begin{itemize}
    \item Hàm mục tiêu JCAS là tổ hợp phi tuyến của nhiều thành phần (main lobe, sidelobe, std).
    \item Gradient phức tạp, các biến thể aggressive (WDGWO, CGWO) dễ "vượt qua" (overshoot) các điểm tối ưu.
\end{itemize}

\paragraph{3. Sự cân bằng exploration-exploitation:}
\begin{itemize}
    \item \textbf{GWO gốc:} Cân bằng tốt với tham số \(a\) tuyến tính giảm từ 2 về 0.
    \item \textbf{WDGWO:} Tăng cường exploitation quá mức, giảm diversity.
    \item \textbf{CGWO:} Giảm exploration do tính deterministic của chaos, bị kẹt local optima.
\end{itemize}

\subsection{Kết luận}

\subsubsection{Kết quả chính}
\begin{enumerate}
    \item \textbf{Trên bài toán JCAS, GWO nguyên bản vẫn là lựa chọn tốt nhất.}
    \item Weighted Dynamic GWO và Chaotic GWO \textbf{không mang lại cải thiện}, thậm chí làm giảm hiệu suất.
    \item Nguyên nhân chính: Không gian tìm kiếm liên tục phức tạp và đa chiều của JCAS không phù hợp với cơ chế dao động mạnh của các biến thể.
\end{enumerate}

\subsubsection{Bài học kinh nghiệm (Lessons Learned)}
\begin{itemize}
    \item \textbf{"No Free Lunch Theorem" (NFL):} Không có thuật toán nào tốt nhất cho mọi bài toán. Cải tiến hiệu quả trên bài toán này có thể phản tác dụng trên bài toán khác.
    \item \textbf{Domain Knowledge:} Cần hiểu rõ đặc điểm bài toán (rời rạc/liên tục, số chiều, landscape) trước khi áp dụng/thiết kế biến thể.
    \item \textbf{Tuning tham số:} Có thể cải thiện WDGWO bằng cách điều chỉnh power parameter (hiện tại = 2.8) hoặc thêm cơ chế adaptive khác.
\end{itemize}

\subsubsection{Hướng cải thiện tiềm năng}
\begin{enumerate}
    \item \textbf{Hybrid approach:} Kết hợp GWO với local search gradient-based (ví dụ: BFGS) để tinh chỉnh.
    \item \textbf{Adaptive power parameter:} Cho WDGWO, power bắt đầu cao (exploration) và giảm dần (exploitation).
    \item \textbf{Dimension reduction:} Giảm số biến tối ưu bằng cách exploit symmetry của ULA.
    \item \textbf{Multi-objective optimization:} Tối ưu đồng thời main lobe gain và sidelobe suppression bằng NSGA-II hoặc MOEA/D.
\end{enumerate}

\subsubsection{Đánh giá theo rubric}
\begin{table}[H]
\centering
\caption{Tự đánh giá theo tiêu chí chấm điểm}
\begin{tabular}{|l|c|p{8cm}|}
\hline
\textbf{Tiêu chí} & \textbf{Điểm} & \textbf{Chứng cứ} \\ \hline
Thực thi thuật toán gốc vào JCAS & 3/3 & Code Python hoàn chỉnh, kết quả rõ ràng (Mean = -6.766) \\ \hline
Thực thi các biến thể vào JCAS & 2/2 & WDGWO và CGWO được implement và chạy đầy đủ 10 trials \\ \hline
So sánh kết quả với bài toán gốc & 1/1 & Bảng so sánh, đồ thị convergence, boxplot, beam patterns \\ \hline
Kết quả cải thiện & 0/1 & \textcolor{red}{Không cải thiện được} - các biến thể kém hơn GWO gốc \\ \hline
\textbf{Tổng} & \textbf{6/7} & Hoàn thành 3 yêu cầu bắt buộc, chưa đạt bonus cải thiện \\ \hline
\end{tabular}
\end{table}

\textbf{Lý do không đạt điểm bonus (+1đ):} Kết quả thực nghiệm cho thấy các biến thể không cải thiện được hiệu suất so với GWO gốc trên bài toán JCAS. Tuy nhiên, phân tích sâu về nguyên nhân và đề xuất hướng cải thiện cho thấy hiểu biết tốt về bản chất vấn đề.

\end{document}